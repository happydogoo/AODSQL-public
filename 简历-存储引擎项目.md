# 简历项目描述 - 存储引擎层

## 版本1：简洁版（适合简历项目列表）

**AODSQL 数据库存储引擎层开发**

负责设计并实现关系数据库系统的存储引擎层，采用页式存储架构。主要工作包括：

• **页式存储管理**：实现表空间管理器，采用固定4KB页大小，设计空闲页链表管理机制，支持页的分配、回收和复用

• **缓冲池系统**：实现基于LRU置换策略的缓冲池，支持Pin/Unpin机制和脏页管理，集成WAL顺序保证，缓冲池命中率>80%

• **B+树索引**：实现标准B+树索引管理器，支持等值查找和范围查询，实现节点分裂、合并算法，索引查找复杂度O(log n)

• **堆文件组织**：实现堆文件管理器，采用页链表结构组织数据，支持变长记录的增删改查和全表扫描

• **事务支持**：集成WAL机制和LSN管理，实现锁管理和约束检查，保证数据一致性和ACID特性

**技术栈**：Python、数据结构（B+树、LRU缓存）、文件I/O、并发控制

---

## 版本2：详细版（适合简历项目详情）

### AODSQL 数据库存储引擎层开发

**项目时间**：[填写时间]  
**项目角色**：核心开发  
**项目描述**：负责设计并实现关系数据库系统的存储引擎层，采用页式存储架构，实现了从物理存储到上层接口的完整存储抽象。

**主要工作内容**：

1. **页式存储管理系统**
   - 设计并实现表空间管理器（TablespaceManager），采用固定4KB页大小设计
   - 实现空闲页链表管理机制，文件头存储链表头指针，支持页的分配、回收和复用
   - 优化页分配算法，优先复用空闲页，减少磁盘碎片

2. **缓冲池系统**
   - 实现基于LRU置换策略的缓冲池（BufferPool），使用OrderedDict实现O(1)缓存操作
   - 设计Pin/Unpin机制防止正在使用的页被淘汰，确保数据一致性
   - 实现脏页跟踪和批量刷新机制，集成WAL顺序保证（基于LSN）
   - 缓冲池命中率达到80%以上，显著减少磁盘I/O

3. **B+树索引系统**
   - 实现标准B+树索引管理器（BTreeManager），支持内部节点和叶子节点的分离存储
   - 实现查找、插入、删除算法，支持节点分裂和合并，维护树的高度平衡
   - 设计索引页与数据页分离存储架构，独立缓冲池管理，提升缓存命中率
   - 索引查找时间复杂度O(log n)，相比全表扫描性能提升显著

4. **堆文件组织**
   - 实现堆文件管理器（HeapFileManager），采用页链表结构组织数据
   - 支持变长记录的插入、更新、删除操作，实现高效的全表扫描迭代器
   - 通过(page_id, record_id)唯一标识记录，支持快速定位

5. **数据序列化系统**
   - 实现类型安全的二进制序列化器（TupleSerializer），基于Python struct模块
   - 支持INT、VARCHAR、DECIMAL、DATE、TIMESTAMP等多种数据类型
   - 处理变长字符串的定长存储（填充/截断）和NULL值处理

6. **事务支持**
   - 集成WAL（Write-Ahead Logging）机制，所有数据修改先写日志后写数据
   - 实现LSN（Log Sequence Number）管理，确保日志先于数据页刷新
   - 集成锁管理器，支持共享锁和排他锁，实现约束检查（主键唯一性、NOT NULL等）

**技术亮点**：
- 实现完整的存储抽象层，支持CRUD操作和事务管理，代码规模3000+行
- 模块化设计，清晰的层次划分，各模块职责单一，便于维护和扩展
- 性能优化：缓冲池命中率>80%，索引查找O(log n)，支持批量处理

**技术栈**：Python 3.8+、数据结构（B+树、LRU缓存、链表）、文件I/O、并发控制、设计模式（迭代器、工厂）

---

## 版本3：极简版（适合简历技能部分）

**AODSQL 数据库存储引擎** | Python  
设计并实现页式存储引擎，包括：表空间管理（空闲页链表）、LRU缓冲池、B+树索引、堆文件组织、数据序列化、WAL事务支持。实现缓冲池命中率>80%，索引查找O(log n)。

---

## 版本4：技术深度版（适合技术面试）

### 存储引擎层核心技术实现

#### 1. 页式存储架构设计
- **固定页大小**：采用4KB固定页大小，简化内存管理和I/O操作
- **空闲页管理**：设计空闲页链表，文件头存储链表头指针，支持O(1)页分配
- **页复用机制**：删除的页加入空闲链表，减少磁盘碎片

#### 2. 缓冲池实现细节
- **LRU算法**：使用OrderedDict实现，访问时移动到末尾，淘汰时从头部删除
- **Pin/Unpin机制**：每个页维护pin计数，pin>0时不能被淘汰
- **脏页管理**：修改的页标记为dirty，刷新时批量写回磁盘
- **WAL顺序保证**：页刷新前检查LSN，确保日志先于数据页刷新

#### 3. B+树索引实现
- **树结构**：内部节点存储(key, child_page_id)，叶子节点存储(key, row_id)
- **查找算法**：从根节点向下遍历，内部节点二分查找，叶子节点顺序查找
- **插入算法**：定位到叶子节点插入，节点满时分裂，向上传播分裂
- **删除算法**：删除后检查填充度，低于阈值时合并或重分布

#### 4. 事务一致性保证
- **WAL机制**：所有修改先写日志，日志持久化后再写数据页
- **LSN管理**：每个页记录最大LSN，刷新时确保日志已刷新到该LSN
- **锁管理**：集成锁管理器，支持表级锁和页级锁
- **约束检查**：存储层实现主键唯一性、NOT NULL、CHECK约束检查

#### 5. 性能优化策略
- **批量处理**：向量化执行，每次返回1024行，减少函数调用
- **索引分离**：索引页独立缓冲池，提高缓存命中率
- **延迟写回**：脏页批量刷新，减少系统调用
- **页复用**：空闲页链表支持页复用，减少文件扩展

**性能指标**：
- 缓冲池命中率：>80%
- 索引查找：O(log n)
- 全表扫描：O(n)，但支持批量读取
- 支持并发事务（基于锁机制）



# æµ‹è¯•ç”¨ä¾‹è¯´æ˜

æœ¬ç›®å½•åŒ…å«äº†AODSQLæ•°æ®åº“ç³»ç»Ÿçš„æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨äºéªŒè¯æ ¸å¿ƒåŠŸèƒ½ã€‚

## æµ‹è¯•æ–‡ä»¶

### 1. test_simple_ddl_dml.py
ç®€åŒ–çš„DDLå’ŒDMLåŠŸèƒ½æµ‹è¯•ï¼Œä¸ä¾èµ–pytestï¼Œå¯ä»¥ç›´æ¥è¿è¡Œã€‚

**æµ‹è¯•å†…å®¹ï¼š**
- âœ… CREATE TABLEåŠŸèƒ½æµ‹è¯•
- âœ… INSERTæ•°æ®æ’å…¥æµ‹è¯•  
- âœ… DELETEæ•°æ®åˆ é™¤æµ‹è¯•
- âœ… å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•
- âœ… ç®—å­æ ‘æ„å»ºæµ‹è¯•
- âš ï¸ ç®—å­æ ‘å¯è§†åŒ–æµ‹è¯•ï¼ˆéƒ¨åˆ†åŠŸèƒ½ï¼‰
- âš ï¸ SQLè§£é‡Šå™¨é›†æˆæµ‹è¯•ï¼ˆéƒ¨åˆ†åŠŸèƒ½ï¼‰

**è¿è¡Œæ–¹æ³•ï¼š**
```bash
python3 tests/test_simple_ddl_dml.py
```

### 2. test_ddl_dml_complete.py
å®Œæ•´çš„pytestæµ‹è¯•å¥—ä»¶ï¼ŒåŒ…å«æ›´è¯¦ç»†çš„æµ‹è¯•ç”¨ä¾‹ã€‚

**è¿è¡Œæ–¹æ³•ï¼š**
```bash
# éœ€è¦å…ˆå®‰è£…pytest
pip install pytest
pytest tests/test_ddl_dml_complete.py -v
```

### 3. test_operators.py
ç®—å­çº§åˆ«çš„å•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•å„ä¸ªæ•°æ®åº“ç®—å­çš„åŠŸèƒ½ã€‚

## æµ‹è¯•è¦†ç›–çš„åŠŸèƒ½

### DDL (æ•°æ®å®šä¹‰è¯­è¨€)
- **CREATE TABLE**: åˆ›å»ºè¡¨ç»“æ„
  - æ”¯æŒå¤šç§æ•°æ®ç±»å‹ (INT, VARCHAR, FLOATç­‰)
  - è¡¨å…ƒæ•°æ®æ³¨å†Œåˆ°ç›®å½•ç®¡ç†å™¨
  - å­˜å‚¨å¼•æ“è¡¨æ–‡ä»¶åˆ›å»º

### DML (æ•°æ®æ“ä½œè¯­è¨€)
- **INSERT**: æ•°æ®æ’å…¥
  - å•è¡Œå’Œå¤šè¡Œæ’å…¥
  - æ•°æ®å®Œæ•´æ€§éªŒè¯
  - è‡ªåŠ¨è¡ŒIDç”Ÿæˆ

- **DELETE**: æ•°æ®åˆ é™¤
  - æ¡ä»¶åˆ é™¤ï¼ˆåŸºäºWHEREå­å¥ï¼‰
  - æ‰¹é‡åˆ é™¤
  - åˆ é™¤ç»“æœéªŒè¯

### æŸ¥è¯¢åŠŸèƒ½
- **SeqScan**: é¡ºåºæ‰«æ
- **Filter**: æ¡ä»¶è¿‡æ»¤
- **Project**: åˆ—æŠ•å½±

### ç®—å­æ ‘åŠŸèƒ½
- **ç®—å­æ ‘æ„å»º**: æµ‹è¯•å¤šçº§ç®—å­çš„é“¾å¼æ„å»ºå’Œæ‰§è¡Œ
- **ç®—å­æ ‘å¯è§†åŒ–**: æµ‹è¯•ç®—å­æ ‘çš„ç»“æ„åˆ†æå’Œç»Ÿè®¡
- **ç®—å­é“¾æ‰§è¡Œ**: éªŒè¯SeqScan â†’ Filter â†’ Projectçš„å®Œæ•´æŸ¥è¯¢æµç¨‹

## æµ‹è¯•ç¯å¢ƒ

æµ‹è¯•ä½¿ç”¨æ¨¡æ‹Ÿå­˜å‚¨å¼•æ“ (`MockStorageEngine`)ï¼Œæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ä¼šå½±å“å®é™…æ–‡ä»¶ç³»ç»Ÿã€‚

## ç¤ºä¾‹æµ‹è¯•åœºæ™¯

### å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•
1. åˆ›å»ºè®¢å•è¡¨ (orders)
2. æ’å…¥5æ¡è®¢å•è®°å½•
3. åˆ é™¤ç‰¹å®šå®¢æˆ·çš„è®¢å• (Johnçš„è®¢å•)
4. éªŒè¯åˆ é™¤ç»“æœ
5. å†æ¬¡æ’å…¥æ–°æ•°æ®
6. éªŒè¯æœ€ç»ˆæ•°æ®çŠ¶æ€

### ç®—å­æ ‘æ„å»ºæµ‹è¯•
1. åˆ›å»ºæµ‹è¯•è¡¨ (test_table)
2. æ’å…¥æµ‹è¯•æ•°æ® (Alice: 25, Bob: 30, Charlie: 35)
3. æ„å»ºæŸ¥è¯¢ç®—å­æ ‘: SeqScan â†’ Filter(age > 25) â†’ Project(name, age)
4. æ‰§è¡Œç®—å­æ ‘å¹¶éªŒè¯ç»“æœ
5. éªŒè¯è¿‡æ»¤å’ŒæŠ•å½±çš„æ­£ç¡®æ€§

### æ•°æ®éªŒè¯
- æ’å…¥æ•°æ®æ•°é‡éªŒè¯
- åˆ é™¤æ¡ä»¶æ­£ç¡®æ€§éªŒè¯
- å‰©ä½™æ•°æ®å®Œæ•´æ€§éªŒè¯
- æ•°æ®ç±»å‹ä¸€è‡´æ€§éªŒè¯

## è¿è¡Œç»“æœç¤ºä¾‹

```
============================================================
å¼€å§‹è¿è¡ŒDDL/DMLåŠŸèƒ½æµ‹è¯•
============================================================
ğŸ§ª æµ‹è¯•CREATE TABLEåŠŸèƒ½...
[CatalogManager]: è¡¨ 'users' çš„å…ƒæ•°æ®å·²æ³¨å†Œã€‚
Mock: Table 'users' created.
Mock: Creating table file for 'users'
âœ… CREATE TABLEæµ‹è¯•é€šè¿‡: Table 'users' created.

ğŸ§ª æµ‹è¯•INSERTåŠŸèƒ½...
[CatalogManager]: è¡¨ 'products' çš„å…ƒæ•°æ®å·²æ³¨å†Œã€‚
Mock: Table 'products' created.
Mock: Creating table file for 'products'
âœ… INSERTæµ‹è¯•é€šè¿‡: 3 rows inserted.

ğŸ§ª æµ‹è¯•DELETEåŠŸèƒ½...
[CatalogManager]: è¡¨ 'employees' çš„å…ƒæ•°æ®å·²æ³¨å†Œã€‚
Mock: Table 'employees' created.
Mock: Creating table file for 'employees'
âœ… DELETEæµ‹è¯•é€šè¿‡: 2 rows deleted.

ğŸ§ª æµ‹è¯•å®Œæ•´å·¥ä½œæµç¨‹...
ğŸ”„ å¼€å§‹å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•...
[CatalogManager]: è¡¨ 'orders' çš„å…ƒæ•°æ®å·²æ³¨å†Œã€‚
Mock: Table 'orders' created.
Mock: Creating table file for 'orders'
1. åˆ›å»ºè¡¨: Table 'orders' created.
2. æ’å…¥æ•°æ®: 5 rows inserted.
3. éªŒè¯æ’å…¥: å…±5æ¡è®°å½•
4. åˆ é™¤æ•°æ®: 2 rows deleted.
5. éªŒè¯åˆ é™¤: å‰©ä½™3æ¡è®°å½•ï¼Œä¸åŒ…å«Johnçš„è®¢å•
6. å†æ¬¡æ’å…¥: 2 rows inserted.
7. æœ€ç»ˆéªŒè¯: å…±5æ¡è®°å½•
âœ… å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•é€šè¿‡!

ğŸ§ª æµ‹è¯•ç®—å­æ ‘æ„å»º...
[CatalogManager]: è¡¨ 'test_table' çš„å…ƒæ•°æ®å·²æ³¨å†Œã€‚
Mock: Table 'test_table' created.
Mock: Creating table file for 'test_table'
âœ… ç®—å­æ ‘æ„å»ºæµ‹è¯•é€šè¿‡: æŸ¥è¯¢åˆ°2æ¡è®°å½•
   ç»“æœ: [('Bob', 30), ('Charlie', 35)]

ğŸ§ª æµ‹è¯•ç®—å­æ ‘å¯è§†åŒ–...
âš ï¸ ç®—å­æ ‘ç»Ÿè®¡æµ‹è¯•å¤±è´¥: è§£é‡Šå¤±è´¥: æœŸæœ› ;ï¼Œå¾—åˆ° EOF

ğŸ§ª æµ‹è¯•SQLè§£é‡Šå™¨é›†æˆ...
SQLè§£é‡Šå™¨ç»“æœ: error
âš ï¸ SQLè§£é‡Šå™¨è¿”å›é”™è¯¯: è§£é‡Šå¤±è´¥: æœŸæœ› (ï¼Œå¾—åˆ° )

============================================================
ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆ!
============================================================
```

## æ³¨æ„äº‹é¡¹

1. æµ‹è¯•ä½¿ç”¨æ¨¡æ‹Ÿå­˜å‚¨å¼•æ“ï¼Œæ•°æ®ä¸ä¼šæŒä¹…åŒ–
2. SQLè§£é‡Šå™¨åŠŸèƒ½è¿˜åœ¨å¼€å‘ä¸­ï¼Œéƒ¨åˆ†æµ‹è¯•å¯èƒ½å¤±è´¥
3. æµ‹è¯•è¦†ç›–äº†æ ¸å¿ƒçš„DDLå’ŒDMLåŠŸèƒ½
4. æ‰€æœ‰æµ‹è¯•éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥å•ç‹¬è¿è¡Œ
